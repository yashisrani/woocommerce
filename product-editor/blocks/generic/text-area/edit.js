"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextAreaBlockEdit=void 0;const i18n_1=require("@wordpress/i18n"),block_templates_1=require("@woocommerce/block-templates"),element_1=require("@wordpress/element"),components_1=require("@wordpress/components"),compose_1=require("@wordpress/compose"),block_editor_1=require("@wordpress/block-editor"),classnames_1=__importDefault(require("classnames")),toolbar_button_rtl_1=require("./toolbar/toolbar-button-rtl"),toolbar_button_alignment_1=__importDefault(require("./toolbar/toolbar-button-alignment")),use_clear_selected_block_on_blur_1=require("../../../hooks/use-clear-selected-block-on-blur"),use_product_entity_prop_1=__importDefault(require("../../../hooks/use-product-entity-prop")),label_1=require("../../../components/label/label");function TextAreaBlockEdit({attributes,setAttributes,context:{postType}}){const{property,label,placeholder,help,required,note,tooltip,disabled=!1,align,allowedFormats,direction,mode="rich-text"}=attributes,blockProps=(0,block_templates_1.useWooBlockProps)(attributes,{className:"wp-block-woocommerce-product-text-area-field",style:{direction}}),contentId=(0,compose_1.useInstanceId)(TextAreaBlockEdit,"wp-block-woocommerce-product-content-field__content"),labelId=contentId.toString()+"__label";if(!property)throw new Error((0,i18n_1.__)("Property attribute is required.","woocommerce"));const[content,setContent]=(0,use_product_entity_prop_1.default)(property,{postType}),{handleBlur:hideToolbar}=(0,use_clear_selected_block_on_blur_1.useClearSelectedBlockOnBlur)();const richTextRef=(0,element_1.useRef)(null),textAreaRef=(0,element_1.useRef)(null);const isRichTextMode="rich-text"===mode,isPlainTextMode="plain-text"===mode;return(0,element_1.createElement)("div",{...blockProps},isRichTextMode&&(0,element_1.createElement)(block_editor_1.BlockControls,{group:"block"},(0,element_1.createElement)(toolbar_button_alignment_1.default,{align,setAlignment:function setAlignment(value){setAttributes({align:value})}}),(0,element_1.createElement)(toolbar_button_rtl_1.RTLToolbarButton,{direction,onChange:function changeDirection(value){setAttributes({direction:value})}})),(0,element_1.createElement)(components_1.BaseControl,{id:contentId.toString(),label:(0,element_1.createElement)(label_1.Label,{label:label||"",labelId,required,note,tooltip,onClick:isRichTextMode?function focusRichText(){var _a;null===(_a=richTextRef.current)||void 0===_a||_a.focus()}:function focusTextArea(){var _a;null===(_a=textAreaRef.current)||void 0===_a||_a.focus()}}),help},isRichTextMode&&(0,element_1.createElement)(block_editor_1.RichText,{ref:richTextRef,id:contentId.toString(),"aria-labelledby":labelId,identifier:"content",tagName:"p",value:content||"",onChange:setContent,"data-empty":Boolean(content),className:(0,classnames_1.default)("components-summary-control",{[`has-text-align-${align}`]:align}),dir:direction,allowedFormats,placeholder,required,"aria-required":required,readOnly:disabled,onBlur:hideToolbar}),isPlainTextMode&&(0,element_1.createElement)(components_1.TextareaControl,{ref:textAreaRef,"aria-labelledby":labelId,value:content||"",onChange:setContent,placeholder,required,disabled,onBlur:hideToolbar})))}exports.TextAreaBlockEdit=TextAreaBlockEdit;