"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const element_1=require("@wordpress/element"),data_1=require("@wordpress/data"),components_1=require("@woocommerce/components");async function getTaxonomiesMissingParents(taxonomies,taxonomyName){const missingParentIds=[],taxonomiesLookup={};return taxonomies.forEach((taxonomy=>{taxonomiesLookup[taxonomy.id]=taxonomy})),taxonomies.forEach((taxonomy=>{taxonomy.parent>0&&!taxonomiesLookup[taxonomy.parent]&&missingParentIds.push(taxonomy.parent)})),missingParentIds.length>0?(0,data_1.resolveSelect)("core").getEntityRecords("taxonomy",taxonomyName,{include:missingParentIds}).then((parentTaxonomies=>getTaxonomiesMissingParents([...parentTaxonomies,...taxonomies],taxonomyName))):taxonomies}const PAGINATION_SIZE=30,useTaxonomySearch=(taxonomyName,options={fetchParents:!0})=>{const[isSearching,setIsSearching]=(0,element_1.useState)(!1);return{searchEntity:async function searchEntity(search){setIsSearching(!0);let taxonomies=[];try{taxonomies=await(0,data_1.resolveSelect)("core").getEntityRecords("taxonomy",taxonomyName,{per_page:30,search:(0,components_1.escapeHTML)(search)}),(null==options?void 0:options.fetchParents)&&(taxonomies=await getTaxonomiesMissingParents(taxonomies,taxonomyName))}finally{setIsSearching(!1)}return taxonomies},isResolving:isSearching}};exports.default=useTaxonomySearch;