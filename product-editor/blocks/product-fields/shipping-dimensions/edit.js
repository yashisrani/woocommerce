"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Edit=void 0;const block_templates_1=require("@woocommerce/block-templates"),data_1=require("@woocommerce/data"),core_data_1=require("@wordpress/core-data"),data_2=require("@wordpress/data"),element_1=require("@wordpress/element"),i18n_1=require("@wordpress/i18n"),shipping_dimensions_image_1=require("../../../components/shipping-dimensions-image"),validation_context_1=require("../../../contexts/validation-context"),number_control_1=require("../../../components/number-control"),SHIPPING_AND_WEIGHT_MIN_VALUE=0,SHIPPING_AND_WEIGHT_MAX_VALUE=1e14;function Edit({attributes,clientId,context}){var _a,_b,_c;const blockProps=(0,block_templates_1.useWooBlockProps)(attributes),[dimensions,setDimensions]=(0,core_data_1.useEntityProp)("postType",context.postType,"dimensions"),[weight,setWeight]=(0,core_data_1.useEntityProp)("postType",context.postType,"weight"),[virtual]=(0,core_data_1.useEntityProp)("postType",context.postType,"virtual"),[highlightSide,setHighlightSide]=(0,element_1.useState)(),{dimensionUnit,weightUnit}=(0,data_2.useSelect)((select=>{const{getOption}=select(data_1.OPTIONS_STORE_NAME);return{dimensionUnit:getOption("woocommerce_dimension_unit"),weightUnit:getOption("woocommerce_weight_unit")}}),[]);function getDimensionsControlProps(name,side){var _a;return{name:`dimensions.${name}`,value:null!==(_a=dimensions&&dimensions[name])&&void 0!==_a?_a:"",onChange:value=>setDimensions({...null!=dimensions?dimensions:{},[name]:value}),onFocus:()=>setHighlightSide(side),onBlur:()=>setHighlightSide(void 0),suffix:dimensionUnit,disabled:attributes.disabled||virtual,min:0,max:1e14}}const widthFieldId=`dimensions_width-${clientId}`,{ref:dimensionsWidthRef,error:dimensionsWidthValidationError,validate:validateDimensionsWidth}=(0,validation_context_1.useValidation)(widthFieldId,(async function dimensionsWidthValidator(){if((null==dimensions?void 0:dimensions.width)&&+dimensions.width<=0)return{message:(0,i18n_1.__)("Width must be greater than zero.","woocommerce")}}),[null==dimensions?void 0:dimensions.width]),lengthFieldId=`dimensions_length-${clientId}`,{ref:dimensionsLengthRef,error:dimensionsLengthValidationError,validate:validateDimensionsLength}=(0,validation_context_1.useValidation)(lengthFieldId,(async function dimensionsLengthValidator(){if((null==dimensions?void 0:dimensions.length)&&+dimensions.length<=0)return{message:(0,i18n_1.__)("Length must be greater than zero.","woocommerce")}}),[null==dimensions?void 0:dimensions.length]),heightFieldId=`dimensions_height-${clientId}`,{ref:dimensionsHeightRef,error:dimensionsHeightValidationError,validate:validateDimensionsHeight}=(0,validation_context_1.useValidation)(heightFieldId,(async function dimensionsHeightValidator(){if((null==dimensions?void 0:dimensions.height)&&+dimensions.height<=0)return{message:(0,i18n_1.__)("Height must be greater than zero.","woocommerce")}}),[null==dimensions?void 0:dimensions.height]),weightFieldId=`weight-${clientId}`,{ref:weightRef,error:weightValidationError,validate:validateWeight}=(0,validation_context_1.useValidation)(weightFieldId,(async function weightValidator(){if(weight&&+weight<=0)return{message:(0,i18n_1.__)("Weight must be greater than zero.","woocommerce")}}),[weight]),dimensionsWidthProps={...getDimensionsControlProps("width","A"),ref:dimensionsWidthRef,onBlur:validateDimensionsWidth,id:widthFieldId},dimensionsLengthProps={...getDimensionsControlProps("length","B"),ref:dimensionsLengthRef,onBlur:validateDimensionsLength,id:lengthFieldId},dimensionsHeightProps={...getDimensionsControlProps("height","C"),ref:dimensionsHeightRef,onBlur:validateDimensionsHeight,id:heightFieldId},weightProps={id:weightFieldId,name:"weight",value:null!=weight?weight:"",onChange:setWeight,suffix:weightUnit,ref:weightRef,onBlur:validateWeight,disabled:attributes.disabled||virtual,min:0,max:1e14};return(0,element_1.createElement)("div",{...blockProps},(0,element_1.createElement)("h4",null,(0,i18n_1.__)("Dimensions","woocommerce")),(0,element_1.createElement)("div",{className:"wp-block-columns"},(0,element_1.createElement)("div",{className:"wp-block-column"},(0,element_1.createElement)(number_control_1.NumberControl,{label:(0,element_1.createInterpolateElement)((0,i18n_1.__)("Width <Side />","woocommerce"),{Side:(0,element_1.createElement)("span",null,"A")}),error:dimensionsWidthValidationError,...dimensionsWidthProps}),(0,element_1.createElement)(number_control_1.NumberControl,{label:(0,element_1.createInterpolateElement)((0,i18n_1.__)("Length <Side />","woocommerce"),{Side:(0,element_1.createElement)("span",null,"B")}),error:dimensionsLengthValidationError,...dimensionsLengthProps}),(0,element_1.createElement)(number_control_1.NumberControl,{label:(0,element_1.createInterpolateElement)((0,i18n_1.__)("Height <Side />","woocommerce"),{Side:(0,element_1.createElement)("span",null,"C")}),error:dimensionsHeightValidationError,...dimensionsHeightProps}),(0,element_1.createElement)(number_control_1.NumberControl,{label:(0,i18n_1.__)("Weight","woocommerce"),error:weightValidationError,...weightProps})),(0,element_1.createElement)("div",{className:"wp-block-column"},(0,element_1.createElement)(shipping_dimensions_image_1.ShippingDimensionsImage,{highlight:highlightSide,className:"wp-block-woocommerce-product-shipping-dimensions-fields__dimensions-image",labels:{A:(null===(_a=dimensionsWidthProps.value)||void 0===_a?void 0:_a.length)?dimensionsWidthProps.value:void 0,B:(null===(_b=dimensionsLengthProps.value)||void 0===_b?void 0:_b.length)?dimensionsLengthProps.value:void 0,C:(null===(_c=dimensionsHeightProps.value)||void 0===_c?void 0:_c.length)?dimensionsHeightProps.value:void 0}}))))}exports.Edit=Edit;